<Window x:Class="SlideExtractor.WPF.Views.MainWindow"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:local="clr-namespace:SlideExtractor.WPF.Views"
		xmlns:properties="clr-namespace:SlideExtractor.WPF.Properties"
		xmlns:helpers="clr-namespace:SlideExtractor.WPF.Helpers"
		mc:Ignorable="d"
		Title="视频幻灯片提取器"
		Background="{DynamicResource BackgroundBrush}"
		Foreground="{DynamicResource ForegroundBrush}">
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
			<RowDefinition Height="Auto" />
		</Grid.RowDefinitions>

		<Border Grid.Row="0" Margin="16" Padding="16" Background="{DynamicResource SurfaceBrush}" CornerRadius="12" helpers:DragDropHelper.IsVideoDropTarget="True">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>

				<StackPanel>
					<TextBlock Text="拖拽 MP4 文件到此处" FontSize="18" FontWeight="Bold" />
					<TextBox Margin="0,8,0,0" Text="{Binding SelectedVideoPath, UpdateSourceTrigger=PropertyChanged}" />
					<StackPanel Orientation="Horizontal" Margin="0,8,0,0">
						<Button Content="浏览 (Ctrl+O)" Command="{Binding BrowseCommand}" Margin="0,0,8,0" />
						<Button Content="清除" Command="{Binding ClearVideoCommand}" />
					</StackPanel>
				</StackPanel>

				<StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center">
					<Button Content="开始提取" Command="{Binding StartExtractionCommand}" />
					<Button Content="取消" Command="{Binding CancelCommand}" Margin="0,8,0,0" />
				</StackPanel>
			</Grid>
		</Border>

		<Grid Grid.Row="1" Margin="16">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="2*" />
				<ColumnDefinition Width="*" />
			</Grid.ColumnDefinitions>

			<DockPanel>
				<StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="0,0,0,12">
					<Button Content="导出图片" Command="{Binding ExportImagesCommand}" />
					<TextBlock Text="若需减少帧数，请到“视频”设置页调大帧间隔。" VerticalAlignment="Center"
							   Foreground="{DynamicResource MutedForegroundBrush}" />
				</StackPanel>
				<local:SlideSelectionView x:Name="SlideSelectionHost" />
			</DockPanel>

			<local:SettingsView x:Name="SettingsHost" Grid.Column="1" Margin="16,0,0,0" />
		</Grid>

		<Border Grid.Row="2" Margin="16" Padding="12" Background="{DynamicResource SurfaceBrush}" CornerRadius="12">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="120" />
				</Grid.RowDefinitions>
				<ProgressBar Grid.Row="0" Minimum="0" Maximum="{Binding ProgressMaximum}" Value="{Binding ProgressValue}" Height="12" />
				<TextBlock Grid.Row="1" Text="{Binding StatusText}" Margin="0,8,0,8" />
				<Border Grid.Row="2" BorderBrush="{DynamicResource AccentBrush}" BorderThickness="1" CornerRadius="8" Padding="4">
					<ListBox ItemsSource="{Binding LogEntries}" Background="Transparent" BorderThickness="0" Foreground="{DynamicResource ForegroundBrush}" />
				</Border>
			</Grid>
		</Border>
	</Grid>
</Window>
